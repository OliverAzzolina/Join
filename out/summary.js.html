<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>summary.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#FilteredTasks">FilteredTasks</a></li><li><a href="global.html#activateCheckCancelButtons">activateCheckCancelButtons</a></li><li><a href="global.html#addAssignedEditors">addAssignedEditors</a></li><li><a href="global.html#addAssignedEditorsAddOverlay">addAssignedEditorsAddOverlay</a></li><li><a href="global.html#addNewTask">addNewTask</a></li><li><a href="global.html#addSubtask">addSubtask</a></li><li><a href="global.html#addSubtaskEditOverlay">addSubtaskEditOverlay</a></li><li><a href="global.html#addTask">addTask</a></li><li><a href="global.html#addUserToDatabase">addUserToDatabase</a></li><li><a href="global.html#addUserToUserContacts">addUserToUserContacts</a></li><li><a href="global.html#allowDrop">allowDrop</a></li><li><a href="global.html#awaitingFeedbackCounter">awaitingFeedbackCounter</a></li><li><a href="global.html#changeImage">changeImage</a></li><li><a href="global.html#changeImageDoneRight">changeImageDoneRight</a></li><li><a href="global.html#changeSubtask">changeSubtask</a></li><li><a href="global.html#changeTask">changeTask</a></li><li><a href="global.html#checkCategory">checkCategory</a></li><li><a href="global.html#checkEmail">checkEmail</a></li><li><a href="global.html#checkForEnter">checkForEnter</a></li><li><a href="global.html#checkForm">checkForm</a></li><li><a href="global.html#checkIfAssigned">checkIfAssigned</a></li><li><a href="global.html#checkIfBoardEmpty">checkIfBoardEmpty</a></li><li><a href="global.html#checkIfContactCheckboxChecked">checkIfContactCheckboxChecked</a></li><li><a href="global.html#checkIfEditorsExist">checkIfEditorsExist</a></li><li><a href="global.html#checkIfSubChecked">checkIfSubChecked</a></li><li><a href="global.html#checkIfSubsDone">checkIfSubsDone</a></li><li><a href="global.html#checkIfToMuchEditors">checkIfToMuchEditors</a></li><li><a href="global.html#checkIfToMuchEditorsDetail">checkIfToMuchEditorsDetail</a></li><li><a href="global.html#checkIfToMuchEditorsEdit">checkIfToMuchEditorsEdit</a></li><li><a href="global.html#checkIfUserAlreadyExists">checkIfUserAlreadyExists</a></li><li><a href="global.html#checkIfUserIdAlreadyExists">checkIfUserIdAlreadyExists</a></li><li><a href="global.html#checkName">checkName</a></li><li><a href="global.html#checkOpen">checkOpen</a></li><li><a href="global.html#checkOverlayCategory">checkOverlayCategory</a></li><li><a href="global.html#checkPasswords">checkPasswords</a></li><li><a href="global.html#checkPrivacyCheckbox">checkPrivacyCheckbox</a></li><li><a href="global.html#checkRemoteStorage">checkRemoteStorage</a></li><li><a href="global.html#checkRemoteStorageTasks">checkRemoteStorageTasks</a></li><li><a href="global.html#checkRemoteStorageUsers">checkRemoteStorageUsers</a></li><li><a href="global.html#checkboxAlert">checkboxAlert</a></li><li><a href="global.html#clearAssignedTo">clearAssignedTo</a></li><li><a href="global.html#clearAssignedToAddOverlay">clearAssignedToAddOverlay</a></li><li><a href="global.html#clearDataBase">clearDataBase</a></li><li><a href="global.html#clearSubtaskInput">clearSubtaskInput</a></li><li><a href="global.html#closeAddTaskCard">closeAddTaskCard</a></li><li><a href="global.html#closeDetailCard">closeDetailCard</a></li><li><a href="global.html#closeEditOverlay">closeEditOverlay</a></li><li><a href="global.html#createSubtasksDoneArray">createSubtasksDoneArray</a></li><li><a href="global.html#createSubtasksDoneArrayEditOverlay">createSubtasksDoneArrayEditOverlay</a></li><li><a href="global.html#deleteSubtask">deleteSubtask</a></li><li><a href="global.html#deleteSubtaskEditOverlay">deleteSubtaskEditOverlay</a></li><li><a href="global.html#deleteTask">deleteTask</a></li><li><a href="global.html#doNotClose">doNotClose</a></li><li><a href="global.html#doneCounter">doneCounter</a></li><li><a href="global.html#editSubtask">editSubtask</a></li><li><a href="global.html#editSubtaskEditOverlay">editSubtaskEditOverlay</a></li><li><a href="global.html#filterTasks">filterTasks</a></li><li><a href="global.html#findEditorInContacts">findEditorInContacts</a></li><li><a href="global.html#findUser">findUser</a></li><li><a href="global.html#formatDate">formatDate</a></li><li><a href="global.html#generateHeader">generateHeader</a></li><li><a href="global.html#generateLogin">generateLogin</a></li><li><a href="global.html#generateRandomColor">generateRandomColor</a></li><li><a href="global.html#generateRandomId">generateRandomId</a></li><li><a href="global.html#generateRegister">generateRegister</a></li><li><a href="global.html#generateSidebar">generateSidebar</a></li><li><a href="global.html#generateSubtasks">generateSubtasks</a></li><li><a href="global.html#generateSummary">generateSummary</a></li><li><a href="global.html#getCategoryValue">getCategoryValue</a></li><li><a href="global.html#getItem">getItem</a></li><li><a href="global.html#getSubTasksDone">getSubTasksDone</a></li><li><a href="global.html#getTaskArray">getTaskArray</a></li><li><a href="global.html#getUserArray">getUserArray</a></li><li><a href="global.html#getUserData">getUserData</a></li><li><a href="global.html#goHome">goHome</a></li><li><a href="global.html#greetingDaytime">greetingDaytime</a></li><li><a href="global.html#guestLogin">guestLogin</a></li><li><a href="global.html#hideDragHereContainer">hideDragHereContainer</a></li><li><a href="global.html#hideDropdownContacts">hideDropdownContacts</a></li><li><a href="global.html#hideDropdownContactsAdd">hideDropdownContactsAdd</a></li><li><a href="global.html#hideIcons">hideIcons</a></li><li><a href="global.html#hideSubInfo">hideSubInfo</a></li><li><a href="global.html#hover">hover</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#inputAlert">inputAlert</a></li><li><a href="global.html#loadContactList">loadContactList</a></li><li><a href="global.html#loadContactsForAddOverlay">loadContactsForAddOverlay</a></li><li><a href="global.html#loadLoginListeners">loadLoginListeners</a></li><li><a href="global.html#loadRegisterListeners">loadRegisterListeners</a></li><li><a href="global.html#loadTaskData">loadTaskData</a></li><li><a href="global.html#loadTasksfromStorage">loadTasksfromStorage</a></li><li><a href="global.html#loadUserContacts">loadUserContacts</a></li><li><a href="global.html#loginUser">loginUser</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#logoutRemoteArray">logoutRemoteArray</a></li><li><a href="global.html#moveTo">moveTo</a></li><li><a href="global.html#notToMuchEditors">notToMuchEditors</a></li><li><a href="global.html#notToMuchEditorsDetail">notToMuchEditorsDetail</a></li><li><a href="global.html#notToMuchEditorsEdit">notToMuchEditorsEdit</a></li><li><a href="global.html#openAddTaskCard">openAddTaskCard</a></li><li><a href="global.html#openChangeTaskPopup">openChangeTaskPopup</a></li><li><a href="global.html#openEditOverlay">openEditOverlay</a></li><li><a href="global.html#openTaskDetails">openTaskDetails</a></li><li><a href="global.html#pushAssignedTo">pushAssignedTo</a></li><li><a href="global.html#refreshTasks">refreshTasks</a></li><li><a href="global.html#registerUser">registerUser</a></li><li><a href="global.html#removeAllAlerts">removeAllAlerts</a></li><li><a href="global.html#removeInitFadeIn">removeInitFadeIn</a></li><li><a href="global.html#removeInputAlert">removeInputAlert</a></li><li><a href="global.html#removeLogoTransition">removeLogoTransition</a></li><li><a href="global.html#renderAssignedTo">renderAssignedTo</a></li><li><a href="global.html#renderAssignedToCards">renderAssignedToCards</a></li><li><a href="global.html#renderAssignedToDetail">renderAssignedToDetail</a></li><li><a href="global.html#renderAssignedToEdit">renderAssignedToEdit</a></li><li><a href="global.html#renderDetailSubtasks">renderDetailSubtasks</a></li><li><a href="global.html#renderEditSubtasks">renderEditSubtasks</a></li><li><a href="global.html#renderFilteredTasks">renderFilteredTasks</a></li><li><a href="global.html#renderSubtasks">renderSubtasks</a></li><li><a href="global.html#renderTasks">renderTasks</a></li><li><a href="global.html#resetColors">resetColors</a></li><li><a href="global.html#resetImage">resetImage</a></li><li><a href="global.html#resetImageDoneRight">resetImageDoneRight</a></li><li><a href="global.html#resetPrioColors">resetPrioColors</a></li><li><a href="global.html#resetTaskArray">resetTaskArray</a></li><li><a href="global.html#resetUserArray">resetUserArray</a></li><li><a href="global.html#saveNewAddedTask">saveNewAddedTask</a></li><li><a href="global.html#saveTask">saveTask</a></li><li><a href="global.html#setAssigned">setAssigned</a></li><li><a href="global.html#setChecked">setChecked</a></li><li><a href="global.html#setGuestUser">setGuestUser</a></li><li><a href="global.html#setItem">setItem</a></li><li><a href="global.html#setNewTaskPrio">setNewTaskPrio</a></li><li><a href="global.html#setPrio">setPrio</a></li><li><a href="global.html#setPrioDetailImg">setPrioDetailImg</a></li><li><a href="global.html#setPrioImg">setPrioImg</a></li><li><a href="global.html#setUnAssigned">setUnAssigned</a></li><li><a href="global.html#setUnChecked">setUnChecked</a></li><li><a href="global.html#showDragHereContainer">showDragHereContainer</a></li><li><a href="global.html#showDropdownContacts">showDropdownContacts</a></li><li><a href="global.html#showDropdownContactsAddOverlay">showDropdownContactsAddOverlay</a></li><li><a href="global.html#showEditPrio">showEditPrio</a></li><li><a href="global.html#showIcons">showIcons</a></li><li><a href="global.html#showMessageOverlay">showMessageOverlay</a></li><li><a href="global.html#showPrio">showPrio</a></li><li><a href="global.html#showSubInfo">showSubInfo</a></li><li><a href="global.html#showUsersOnRemoteStorage">showUsersOnRemoteStorage</a></li><li><a href="global.html#slideOutOverlay">slideOutOverlay</a></li><li><a href="global.html#startDragging">startDragging</a></li><li><a href="global.html#stopDragging">stopDragging</a></li><li><a href="global.html#switchToLogin">switchToLogin</a></li><li><a href="global.html#switchToRegister">switchToRegister</a></li><li><a href="global.html#tibCounter">tibCounter</a></li><li><a href="global.html#tipCounter">tipCounter</a></li><li><a href="global.html#toDoCounter">toDoCounter</a></li><li><a href="global.html#toggleDropdown">toggleDropdown</a></li><li><a href="global.html#toggleFadeIn">toggleFadeIn</a></li><li><a href="global.html#toggleFadeOut">toggleFadeOut</a></li><li><a href="global.html#unhover">unhover</a></li><li><a href="global.html#updateDoneSubs">updateDoneSubs</a></li><li><a href="global.html#urgentCounter">urgentCounter</a></li><li><a href="global.html#urgentDeadline">urgentDeadline</a></li><li><a href="global.html#userGreetingName">userGreetingName</a></li><li><a href="global.html#userIsAllowed">userIsAllowed</a></li><li><a href="global.html#userIsLoggedIn">userIsLoggedIn</a></li><li><a href="global.html#validateEmail">validateEmail</a></li><li><a href="global.html#validateForm">validateForm</a></li><li><a href="global.html#validateName">validateName</a></li><li><a href="global.html#validatePassword">validatePassword</a></li><li><a href="global.html#validatePrivacyCheckbox">validatePrivacyCheckbox</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">summary.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Adds an event listener to the "DOMContentLoaded" event of the document, triggering the initialization process when the DOM content is loaded.
 */
document.addEventListener("DOMContentLoaded", function () {
  init();
});


/**
 * Initializes the summary page.
 * Checks if the user is allowed to access the page, generates the sidebar and summary, loads user data, and generates the header with user initials.
 */
async function init() {
  await userIsAllowed();
  await generateSidebar();
  await generateSummary();
  await loadUserData();
  generateHeader(userInitials);
}


/**
 * Retrieves user data based on the stored user ID in localStorage.
 * Redirects to the index page if the user ID is not found.
 * @returns {Object|null} The user data object if found, otherwise null.
 */
async function getUserData() {
  let userId = Number(localStorage.getItem("userId"));

  if (!userId) {
    window.location.href = "index.html";
    return null;
  }
  let users = await getUserArray()
  const userWithSameId = users.find(user => user.userId === userId);
  return userWithSameId;
}


/**
 * Generates the summary page content based on various counters and user information.
 * @returns {void}
 */
async function generateSummary() {
    let main = document.getElementById("main-container");
    main.innerHTML = summaryHTML(await toDoCounter(), await doneCounter(), await urgentCounter(), await urgentDeadline(), await tibCounter(), await tipCounter(), await awaitingFeedbackCounter(), await greetingDaytime(), await userGreetingName());
}


/**
 * Counts the number of tasks that are in "Open" or "In Progress" status and assigned to the logged-in user.
 * @returns {Promise&lt;number>} The count of tasks in "Open" or "In Progress" status assigned to the user.
 */
async function toDoCounter() {
  let tasks = await getTaskArray();
  let userId = parseInt(localStorage.getItem("userId"), 10);
  
  let tasksInOpenStatus = tasks.filter((task) => {
    return (
        task.assignedTo &amp;&amp; task.assignedTo.some((user) => user.userId &amp;&amp; parseInt(user.userId, 10) === userId) &amp;&amp;
        (task.status === "open" || task.status === "in-progress")
    );
  });

  tasksInOpenStatus.forEach(task => {
    console.log(task);
  });

  let count = tasksInOpenStatus.length;
  return count;
}


/**
 * Counts the number of tasks that are in "Done" status and assigned to the logged-in user.
 * @returns {Promise&lt;number>} The count of tasks in "Done" status assigned to the user.
 */
async function doneCounter() {
    let tasks = await getTaskArray();
    let userId = parseInt(localStorage.getItem("userId"), 10);

    let tasksInProgressStatus = tasks.filter((task) => {
        return (
            task.assignedTo &amp;&amp; task.assignedTo.some((user) => user &amp;&amp; user.userId === userId) &amp;&amp;
            task.status === "done"
        );
    });
    
    let count = tasksInProgressStatus.length;
    return count;
}


/**
 * Counts the number of tasks that are marked as "urgent" and assigned to the logged-in user.
 * @returns {Promise&lt;number>} The count of tasks marked as "urgent" assigned to the user.
 */
async function urgentCounter() {
    let tasks = await getTaskArray();
    let userId = parseInt(localStorage.getItem("userId"), 10);

    let tasksInUrgentStatus = tasks.filter((task) => {
        return (
            task.assignedTo &amp;&amp; task.assignedTo.some((user) => user &amp;&amp; user.userId === userId) &amp;&amp;
            task.prio === "urgent"
        );
    });
    
    let count = tasksInUrgentStatus.length;
    return count;
}


/**
 * Retrieves the due date of the nearest task marked as "urgent".
 * @returns {Promise&lt;string>} The formatted due date of the nearest urgent task.
 */
async function urgentDeadline() {
    let tasks = await getTaskArray();
    let urgentTasks = tasks.filter(task => task.prio === "urgent");

    let nearestUrgentTask = urgentTasks.reduce((prev, current) => {
        return (new Date(prev.dueDate) &lt; new Date(current.dueDate)) ? prev : current;
    }, urgentTasks[0]);

    let dueDateFormatted = formatDate(nearestUrgentTask.dueDate);

    return dueDateFormatted;
}


/**
 * Formats a given date string to a human-readable format.
 * @param {string} dateString - The date string to format.
 * @returns {string} The formatted date string in the format "Month Day, Year".
 */
function formatDate(dateString) {
    let options = { year: 'numeric', month: 'long', day: 'numeric' };
    let date = new Date(dateString);
    return date.toLocaleDateString('en-EN', options);
}


/**
 * Counts the total number of tasks in the backlog.
 * @returns {number} The total number of tasks in the backlog.
 */
async function tibCounter() {
    let tasks = await getTaskArray();
    let count = tasks.length;
    return count;
}


/**
 * Counts the total number of tasks currently in progress.
 * @returns {number} The total number of tasks in progress.
 */
async function tipCounter() {
    let tasks = await getTaskArray();
    let allTasksInProgressStatus = tasks.filter(task => task.status === "in-progress");
    let count = allTasksInProgressStatus.length;
    return count;
}


/**
 * Counts the total number of tasks awaiting feedback.
 * @returns {number} The total number of tasks awaiting feedback.
 */
async function awaitingFeedbackCounter() {
    let tasks = await getTaskArray();
    let allTasksInProgressStatus = tasks.filter(task => task.status === "await-feedback");
    let count = allTasksInProgressStatus.length;
    return count;
}


/**
 * Determines the appropriate greeting based on the current time of the day.
 * @returns {string} The greeting message for the current time of the day.
 */
function greetingDaytime() {
    let today = new Date();
    let hour = today.getHours();
  
    let greetingText;
    if (hour >= 5 &amp;&amp; hour &lt; 12) {
      greetingText = "Guten Morgen";
    } else if (hour >= 12 &amp;&amp; hour &lt; 17) {
      greetingText = "Guten Tag";
    } else {
      greetingText = "Guten Abend";
    }
    return greetingText;
}


/**
 * Retrieves the user's greeting name based on their first and last name.
 * @returns {string} The user's greeting name.
 */
async function userGreetingName() {
  let user = await getUserData();
  if (!user) {
    console.log("User not found.");
    return "User not found";
  }
  if (user.firstName &amp;&amp; !user.lastName) {
      return user.firstName;
  } else if (user.firstName &amp;&amp; user.lastName) {
      return `${user.firstName} ${user.lastName}`;
  }
}


/**
 * Changes the image source of the given element.
 * @param {HTMLElement} element - The HTML element whose image source will be changed.
 */
function changeImage(element) {
  element.querySelector(".icon").src = "assets/img/todo_white_icon.png";
}


/**
 * Resets the image source of the given element.
 * @param {HTMLElement} element - The HTML element whose image source will be reset.
 */
function resetImage(element) {
  element.querySelector(".icon").src = "assets/img/todo_black_icon.png";
}


/**
 * Changes the image source of the given element to a white "done" icon.
 * @param {HTMLElement} element - The HTML element whose image source will be changed.
 */
function changeImageDoneRight(element) {
  element.querySelector(".icon").src = "assets/img/done_white_icon.png";
}


/**
 * Resets the image source of the given element to a black "done" icon.
 * @param {HTMLElement} element - The HTML element whose image source will be reset.
 */
function resetImageDoneRight(element) {
  element.querySelector(".icon").src = "assets/img/done_black_icon.png";
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Tue Mar 12 2024 00:35:54 GMT+0100 (Mitteleurop√§ische Normalzeit) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
